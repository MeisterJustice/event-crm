let User,passport;_8d5‍.x([["getIndex",()=>getIndex],["getFacebookLogin",()=>getFacebookLogin],["postFacebookLogin",()=>postFacebookLogin],["getRegister",()=>getRegister],["postRegister",()=>postRegister],["getLogin",()=>getLogin],["postLogin",()=>postLogin],["getLogout",()=>getLogout]]);_8d5‍.w("../models/user",[["default",["User"],function(v){User=v}]]);_8d5‍.w("passport",[["default",["passport"],function(v){passport=v}]]);


       const getIndex = (req, res, next) => {
  res.render('index');
}

       const getFacebookLogin = passport.authenticate('facebook', {
  scope: ['email']
});

       const postFacebookLogin = passport.authenticate('facebook', {
  successRedirect: '/',
  failureRedirect: '/',
  session: false
})

       const getRegister = async (req, res, next) => {
  res.json({
    message: 'get register'
  })
}

       const postRegister = async (req, res, next) => {
  let newUser = await new User({
    username: req.body.username,
    firstName: req.body.firstName,
    lastName: req.body.lastName,
    sex: req.body.sex,
    email: req.body.email
  });
  await User.register(newUser, req.body.password);
  // req.flash("success", "welcome");
    res.json({newUser});
}

       const getLogin = async (req, res, next) => {
  res.json({message: 'get login'});
}

       const postLogin = async (req, res, next) => passport.authenticate("local", {
  successRedirect: "/event",
  failureRedirect: "/login"
})(req, res, next)

       const getLogout = async(req, res, next) => {
  req.logout();
  // req.flash("success", "Logged you out!");
  res.redirect("/");
}